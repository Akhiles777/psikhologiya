generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model DataList {
  id        String   @id @default(cuid())
  slug      String   @unique
  name      String
  items     Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("data_lists")
}

model Psychologist {
  id                    String    @id @default(cuid())
  slug                  String    @unique
  fullName              String
  gender                String
  birthDate             DateTime  @db.Date
  city                  String
  workFormat            String
  firstDiplomaDate      DateTime? @db.Date
  lastCertificationDate DateTime? @db.Date
  mainParadigm          String[]
  certificationLevel    Int
  shortBio              String    @db.VarChar(400)
  longBio               String
  price                 Int
  contactInfo           String
  isPublished           Boolean   @default(false)
  education             Json?     @db.Json
  images                String[]
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  articles              Article[]

  @@index([isPublished])
  @@index([price])
  @@index([city])
  @@index([certificationLevel])
  @@index([workFormat])
  @@index([isPublished, price])
  @@map("psychologists")
}

model Article {
  id          String        @id @default(cuid())
  title       String
  slug        String        @unique
  content     String
  tags        String[]
  authorId    String?
  catalogSlug String?
  publishedAt DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  author      Psychologist? @relation(fields: [authorId], references: [id])

  @@index([slug])
  @@index([authorId])
  @@index([publishedAt])
  @@map("articles")
}

model Page {
  id          String   @id @default(cuid())
  slug        String   @unique
  title       String
  template    String
  content     String
  isPublished Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("pages")
}

model MenuItem {
  id       String     @id @default(cuid())
  label    String
  href     String
  order    Int        @default(0)
  parentId String?
  parent   MenuItem?  @relation("MenuTree", fields: [parentId], references: [id], onDelete: Cascade)
  children MenuItem[] @relation("MenuTree")

  @@map("menu_items")
}

enum Role {
  ADMIN
  MANAGER
}
